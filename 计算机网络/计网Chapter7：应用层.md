## 应用层

目的：解决通过应用进程的交互来实现特定网络应用的问题

### 动态主机配置协议DHCP

可在网络中为其它主机配置信息（IP地址、子网掩码、地址租期、默认网关等）

#### 工作过程

DHCP服务器使用UDP端口是67，DHCP客户使用的端口是68

1. DHCP客户广播发送报文寻找DHCP服务器
2. DHCP服务器接收发现报文并做出响应（通过MAC地址查找自己的数据库）。若查找到则使用这些配置信息来构建并发送DHCP提供报文；否则采用默认配置信息提供报文，提供IP地址租用。也是发送广播，在此期间一直会使用ARP检测分配的IP地址是否被其它网络占用
3. DHCP客户接收报文根据事物ID判断是否是自己所请求的报文来接收or丢弃报文，若接收则获得配置信息，接收IP地址租约，再次发送请求报文，但这次不是多播
4. DHCP服务器给DHCP客户发送确认报文，也不是多播，确认IP地址租约，此时仍会使用ARP检测
5. 当租用期过了50%时，DHCP客户需要向DHCP服务器提供请求续约报文
6. DHCP服务器可以向DHCP客户发送确认或拒绝报文来表示是否同意续约
7. DHCP客户可以随时解除IP地址租约

DHCP中继代理：可以给路由器配置DHCP服务器的IP地址并使之成为DHCP中继代理，可以使主机自动获取到IP地址等网络配置信息

### 域名系统DNS

#### DNS概述

DNS的作用：DNS服务器中有域名和IP地址映射的数据库，使得用户可以使用域名而不是IP地址来访问主机。DNS使大多数域名都在本地解析，效率高；并且DNS是分布式系统，各地都存在相应的域名服务器

DNS报文使用运输层UDP协议进行封装，运输层端口号为53

因特网采用层次树状结构的域名结构，域名的结构由若干个分量组成，各分量之间用点隔开，分别代表不同级别的域名

域名服务器类型：根域名服务器、顶级域名服务器、权限域名服务器、本地域名服务器

#### 域名解析的过程

##### 递归查询

简而言之就是一步步递归向上查询，然后一步步向下return

##### 迭代查询

先递归查询，然后在本地域名服务器对上层服务器一层一层访问获得IP地址，然后挨个查询，最终将目的IP地址发送给本地

#### 高速缓存

高速缓存在域名服务器和主机中广泛使用，目的是存放最近查询过的域名以及从何处获得域名映射信息的记录，相当于算法中的记忆化搜索，但每项内容都会设置计时器并删除超过合理时间的项。

### 文件传送协议FTP

将某台计算机的文件通过网络传送到另一台计算机中

FTP提供交互式访问

#### FTP基本工作原理

##### 主动模式

1. FTP客户使用随机选择的临时端口号与FTP服务器的21端口号发起TCP连接，称为控制连接，用于传送FTP相关控制命令
2. 当数据要传输时，FTP客户通过命令通道告知FTP服务器来与自己的另一个临时端口号建立TCP连接，建立数据通道。
3. 新的连接用于FTP建立数据通道，FTP服务器使用自己的20端口主动连接FTP客户，用于文件传输，在每次传输时才建立，传输结束就关闭

##### 被动模式

1. FTP客户使用随机选择的临时端口号与FTP服务器的21端口号发起TCP连接，称为控制连接，用于传送FTP相关控制命令
2. 当数据要传输时，FTP客户通过命令通道告知FTP服务器开启某个临时端口被动等待TCP连接，建立数据通道。
3. 新的连接用于FTP建立数据通道，FTP客户使用另一个临时端口号与FTP服务器随机选择的临时端口号连接以建立数据通道，FTP服务器被动等待FTP客户的连接，同样传输结束就关闭。

### 电子邮件

电子邮件系统采用客户/服务器方式

电子邮件系统的三个主要组成构件：用户代理、邮件服务器、电子邮件所需的协议

### 课后习题

1. 在 OSI 模型中,哪几层协议称为高层协议?
2. TCP/ IP 协议中的应用层与 OSI 应用层有什么区别?
3. Internet中主机的地址有哪些类型?为什么不只使用一种地址编制机制?
4. 什么是 DNS ?它有什么作用?
5. 说明 HOSTS 方式的缺点。
6. 什么是名字服务器?说明其工作过程。
7. 举例说明 DNS 的子域代理机制。
8. 比较 DNS 中“域”和“区”两个概念的区别。
9. 说明 DNS 中重复解释和递归解释的工作过程。
10. 比较 DNS 服务与 ARP 服务的异同点。
11. 一个电子邮件系统由哪些部分组成?
12. 举例说明 POP 协议和 IMAP 协议的工作原理,并比较其区别。
13. SMTP协议在传送邮件时需要哪几个步骤?
14. 使用 SMTP 协议传送邮件时,一个邮件一般需要几个邮件服务器的转发。
15. 什么是 MIME 协议,它对 SMTP 协议的主要扩充是什么?
16. 什么是 FTP 协议?
17. TFTP 协议的主要特点是什么?
18. FTP协议需要几个端口,并说明其作用。
19. 什么是 FTP 的断点续传?并说明其使用场合。
20. 什么是超文本?
21. 什么是 URL ,举例说明其组成格式。
22. 什么是 HTTP 协议,为什么说它是一个无状态的协议?
23. 举例说明 HTTP 协议持续连接和非持续连接的概念。
24. 说明 Web 浏览器的主要组成部分。
25. 举例说明静态文档和动态文档。
26. 说明流行的 Web 服务器结构。
27. 什么是 CGI ,并说明其主要功能。