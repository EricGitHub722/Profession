# 数据链路层

主要工作：

1. 线路规程：分帧、排序
2. 差错控制：为上层提供可靠链路
3. 流量控制：处理输入数据的速率
4. 链路管理：链路的建立，维持，拆除

### 线路规程

线路规程是监视链路的建立，以及在给定时刻分配一个具体设备进行数据传送的权力

线路规程的实现方法

1. **询问/确认方式（ENQ/ACK）**
2. 轮询/选择方式（Poll/Select）

### 流量控制与差错控制

流量控制的要点：数据流不能使接收方过载、接收方对数据进行确认

差错控制主要指错误检测和重传方法

自动重复请求（ARQ）：**数据帧在传输中出现错误，接收方就会返回一个否定应答帧（NAK），出错的帧就会被发送方重新传输。**该过程叫ARQ

数据被重传的情况有三种：帧破坏、帧丢失、应答帧丢失

两种实现流量控制和差错控制的技术：

1. **停止等待协议**
2. **滑动窗口协议**

### 停止等待协议

方法：发送方每发送一帧后就等待应答。只有收到一个应答（ACK）后才发送下一个帧。直到发送方发送一个传输结束帧。

优点：协议简单

缺点：效率低，在线路上只有一帧

发送一帧所需要的时间计算如下
$$
t_W = t_I+2t_p+2t_(Proc)+t_S
$$
tI为发送数据帧时间 = 帧长/数据传输率

tS为发送确认帧时间 = 确认帧长/数据传输率

tP为信号传输延时 = 距离/信号传输速度

tProc为节点处理数据时间

信道利用率：信道被占用的时间和总时间之比

有效数据传输率：单位时间内传输的有效数据位数

无差错情况的信道利用率P
$$
P=(t_I+t_P)/t_W
$$
无差错情况的有效数据传输率
$$
S=N/t_W
$$
其中N是有效数据位数、tW是发送一帧的时间

有差错时正确传送一帧的平均时间
$$
t_V=t_W/(1-p)
$$
p为出错率、tV为发送一帧的平均时间

系统最大吞吐量λmax（每秒成功发送的帧数）
$$
λ_{max} = 1 / t_V
$$
极限吞吐量
$$
M = 1 / t_I
$$
系统传输效率：最大吞吐量/极限吞吐量，经过推导得
$$
ρ = (1 - p) / a
$$
其中a恒等于tW/tI，ρ与a成反比，a越小效率却高







### MAC地址

MAC地址是以太网的MAC子层所使用的地址，属于数据链路层的范畴

使用点对点信道的数据链路层不需要MAC地址

当多个主机连接在一个广播信道时，要想实现主机之间的通信，每个主机都必须要有唯一的标识符。

每个主机的发送帧必须携带标识发送主机和接收主机的地址，由于这类地址适用于媒体接入控制MAC，因此这类地址被称为MAC地址。由于MAC地址一般被固化在只读存储器中，故MAC地址也被称为硬件地址（**有时也被称为物理地址，但MAC地址并不属于网络体系结构中的物理层**）。

MAC地址的发送顺序

单播MAC地址和多播MAC地址

随机MAC地址



### IP地址

IP地址属于网络层的范畴



### ARP协议

目的：解决